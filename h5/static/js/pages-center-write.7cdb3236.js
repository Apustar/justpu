(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-center-write"],{"22f2":function(e,t,i){"use strict";i.r(t);var a=i("fc40"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},"27c3":function(e,t,i){var a=i("3826");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("10ddf06d",a,!0,{sourceMap:!1,shadowMode:!1})},2980:function(e,t,i){"use strict";i.r(t);var a=i("d4db"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},"2c48":function(e,t,i){"use strict";i.r(t);var a=i("f976"),n=i("cd69");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);var s,r=i("f0c5"),l=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"3c93edf2",null,!1,a["a"],s);t["default"]=l.exports},3826:function(e,t,i){var a=i("24fb");t=a(!1),t.push([e.i,".imageUploadContainer[data-v-5c8ad676]{padding:%?10?% %?5?%;margin:%?10?% %?5?%}.name[data-v-5c8ad676]{text-align:center;margin-top:%?-30?%}.dragging[data-v-5c8ad676]{-webkit-transform:scale(1.2);transform:scale(1.2)}.imageUploadList[data-v-5c8ad676]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap}.imageItem[data-v-5c8ad676], .imageUpload[data-v-5c8ad676]{width:%?200?%;height:%?200?%;margin:%?30?% %?15?% %?30?%}.imageDel[data-v-5c8ad676]{position:relative;left:%?180?%;bottom:%?225?%;background-color:rgba(0,0,0,.5);width:%?36?%;text-align:center;line-height:%?35?%;-webkit-border-radius:%?17?%;border-radius:%?17?%;color:#fff;font-size:%?30?%;padding-bottom:%?2?%}.imageItem uni-image[data-v-5c8ad676], .moveImage[data-v-5c8ad676]{width:%?200?%;height:%?200?%;-webkit-border-radius:%?8?%;border-radius:%?8?%}.imageUpload[data-v-5c8ad676]{line-height:%?200?%;text-align:center;font-size:%?150?%;color:#d9d9d9;border:1px solid #d9d9d9;-webkit-border-radius:%?8?%;border-radius:%?8?%}.moveImage[data-v-5c8ad676]{position:absolute}.uni-list[data-v-5c8ad676]{width:260px}.popup_foot[data-v-5c8ad676]{display:-webkit-box;display:-webkit-flex;display:flex;border-top:1px #f9f9f9 solid;line-height:40px;height:40px;margin-top:30px}.build_01[data-v-5c8ad676]{line-height:35px}.build_01 uni-input[data-v-5c8ad676]{background:#ededed}.popup_foot_l[data-v-5c8ad676]{width:50%;text-align:center}.popup_foot_r[data-v-5c8ad676]{width:50%;text-align:center;border-left:1px #f9f9f9 solid;color:#5095d3}",""]),e.exports=t},5913:function(e,t,i){"use strict";var a;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"xinde"},[a("v-uni-view",{staticClass:"title"},[a("v-uni-view",{staticClass:"tit"},[a("v-uni-view",{staticClass:"title_l"},[a("v-uni-input",{attrs:{placeholder:"标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("v-uni-view",{staticClass:"title_r"},[e._v("0/30")])],1)],1),a("v-uni-view",{staticClass:"xd"},[a("v-uni-textarea",{attrs:{placeholder:"分享你的日志...",maxlength:"10000"},model:{value:e.form.article,callback:function(t){e.$set(e.form,"article",t)},expression:"form.article"}})],1),a("v-uni-view",{staticClass:"uni-form-item uni-column cu-form-group img-box"},[a("v-uni-view",{staticClass:"next-title"},[e._v("上传附件")]),a("v-uni-view",{staticClass:"img-wrap margin-none"},[a("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub padding-top"},[e._l(e.fileList,(function(t,n){return a("v-uni-view",{key:n,staticClass:"bg-img"},[e.isfile(e.fileList[n].type)?a("v-uni-image",{staticClass:"img-item",attrs:{src:e.fileList[n].path,mode:"aspectFill",name:"cover"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ViewFile(n)}}}):a("v-uni-image",{staticClass:"img-item",attrs:{src:i("b6aa"),mode:"aspectFill",name:"cover"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ViewFile(n)}}}),a("v-uni-image",{staticClass:"close-img",attrs:{src:i("d724"),"data-index":n,mode:"widthFix"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.DelFile.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"upload_warp_img_div_text cover-image"},[e._v(e._s(e.fileList[n].name))])],1)})),e.fileList.length<9?a("v-uni-view",{staticClass:"add-img",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.ChooseFile.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"cuIcon-add link-color"})],1):e._e()],2)],1)],1),a("v-uni-button",{staticClass:"add-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.sub()}}},[e._v("提交发布")])],1)},o=[]},6688:function(e,t,i){var a=i("24fb");t=a(!1),t.push([e.i,".xinde[data-v-0ff26f5a]{font-size:14px;background-color:#f7f7f5;min-height:100vh}.xinde .add-btn[data-v-0ff26f5a]{position:fixed;left:%?30?%;right:%?30?%;bottom:%?16?%;z-index:95;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;width:%?690?%;height:%?80?%;font-size:%?32?%;color:#fff;background-color:#fa436a;-webkit-border-radius:%?10?%;border-radius:%?10?%;-webkit-box-shadow:1px 2px 5px rgba(219,63,96,.4);box-shadow:1px 2px 5px rgba(219,63,96,.4)}.xinde .pic[data-v-0ff26f5a]{background-color:#fff}.xinde .title[data-v-0ff26f5a]{background-color:#fff;padding:10px}.xinde .title .tit[data-v-0ff26f5a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding:10px 0;border-bottom:1px solid #f6f6f4;line-height:20px}.xinde .title .tit .title_l[data-v-0ff26f5a]{font-size:16px;width:80%}.xinde .title .tit .title_r[data-v-0ff26f5a]{color:#a0a0a0}.xinde .xd[data-v-0ff26f5a]{background-color:#fff}.xinde .xd uni-textarea[data-v-0ff26f5a]{padding:10px 20px 20px;width:100%;line-height:20px}.xinde .tuij[data-v-0ff26f5a]{-webkit-border-radius:5px;border-radius:5px;margin:10px;border:1px #e3e3e3 dashed;background-color:#fdfdfb;display:-webkit-box;display:-webkit-flex;display:flex;height:80px;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.xinde .tuij .tj_t[data-v-0ff26f5a]{color:#ccccca;font-size:16px}.xinde .product[data-v-0ff26f5a]{-webkit-border-radius:5px;border-radius:5px;margin:15px 10px;background-color:#fdfdfb;display:-webkit-box;display:-webkit-flex;display:flex;height:80px;position:relative}.xinde .product .pro_l[data-v-0ff26f5a]{width:80px}.xinde .product .pro_l img[data-v-0ff26f5a]{width:80px;height:80px}.xinde .product .pro_r[data-v-0ff26f5a]{padding:10px;font-size:16px;width:80%}.xinde .product .pro_r .pro_r_01[data-v-0ff26f5a]{height:20px;line-height:20px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.xinde .product .pro_r .pro_r_02[data-v-0ff26f5a]{color:#da3056;font-size:16px;padding-top:15px;font-weight:600}.xinde .product .pro_r .pro_r_02 span[data-v-0ff26f5a]{font-size:12px}.xinde .product .close[data-v-0ff26f5a]{position:absolute;top:-10px;right:-9px}.xinde .ruhe[data-v-0ff26f5a]{padding:10px;text-align:center;color:#999997;font-size:15px}.img-box[data-v-0ff26f5a]{padding:%?0?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;margin-top:%?20?%;margin-bottom:%?0?%}.img-box .next-title[data-v-0ff26f5a]{width:100%;font-size:%?30?%;color:var(--mainColor)}.img-box .font-red[data-v-0ff26f5a]{color:red}.img-box .img-wrap[data-v-0ff26f5a]{width:100%;font-size:%?28?%;line-height:%?44?%;color:#999;margin:%?20?% 0}.img-box .add-img[data-v-0ff26f5a]{border:%?4?% dashed #999;font-size:%?40?%}.bg-img[data-v-0ff26f5a]{overflow:visible!important}.bg-img .img-item[data-v-0ff26f5a]{-webkit-border-radius:%?20?%;border-radius:%?20?%}.bg-img .close-img[data-v-0ff26f5a]{position:absolute;width:%?36?%!important;top:%?-18?%;right:%?-18?%}.upload_warp_img_div_text[data-v-0ff26f5a]{max-height:%?84?%;overflow:hidden;position:absolute;left:%?30?%;bottom:%?30?%;width:90%;font-size:%?32?%;font-weight:400;line-height:%?42?%;color:red;z-index:11}",""]),e.exports=t},"93c5":function(e,t,i){"use strict";var a=i("27c3"),n=i.n(a);n.a},a1ef:function(e,t,i){var a=i("6688");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("ac20dc28",a,!0,{sourceMap:!1,shadowMode:!1})},a27d:function(e,t,i){"use strict";var a;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"imageUploadContainer"},[i("v-uni-view",{staticClass:"imageUploadList"},[e._l(e.value,(function(t,a){return i("v-uni-view",{key:a,staticClass:"imageItem"},[i("v-uni-image",{class:{dragging:e.isDragging(a)},attrs:{src:t.msg,draggable:"true","data-index":a},on:{touchstart:function(t){arguments[0]=t=e.$handleEvent(t),e.start.apply(void 0,arguments)},touchmove:function(t){arguments[0]=t=e.$handleEvent(t),e.move.apply(void 0,arguments)},touchend:function(t){arguments[0]=t=e.$handleEvent(t),e.stop.apply(void 0,arguments)},click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewImage.apply(void 0,arguments)}}}),e.isShowDel?i("v-uni-view",{staticClass:"imageDel",attrs:{"data-index":a},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteImage.apply(void 0,arguments)}}},[e._v("x")]):e._e()],1)})),e.isShowAdd?i("v-uni-view",{staticClass:"imageUpload",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectImage.apply(void 0,arguments)}}},[e._v("+")]):e._e()],2),e.showMoveImage?i("v-uni-image",{staticClass:"moveImage",style:{left:e.posMoveImageLeft,top:e.posMoveImageTop},attrs:{src:e.moveImagePath}}):e._e()],1)},o=[]},a804:function(e,t,i){"use strict";i.r(t);var a=i("5913"),n=i("2980");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("c301");var s,r=i("f0c5"),l=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"0ff26f5a",null,!1,a["a"],s);t["default"]=l.exports},c301:function(e,t,i){"use strict";var a=i("a1ef"),n=i.n(a);n.a},c639:function(e,t,i){"use strict";var a=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(i("a804")),o={data:function(){return{}},components:{xinde:n.default}};t.default=o},cd69:function(e,t,i){"use strict";i.r(t);var a=i("c639"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},d4db:function(e,t,i){"use strict";var a=i("4ea4");i("99af"),i("c975"),i("a434"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(i("f837")),o=a(i("2806")),s={data:function(){return{produ:!1,zc:{},serverUrl:"http://103.222.189.2:9005/deptName/dept_name/uploadConver/",DelServelUrl:"del_img",formData:{use:"zc",back:"idurl"},pics:[],photos:[],form:{title:"",article:""},fileList:[],resfilepath:[]}},components:{uniIcon:o.default,robbyImageUpload:n.default},mounted:function(){var e=uni.getStorageSync("zc");e&&(this.zc=e,this.produ=!0)},methods:{isfile:function(e){return-1!=e.indexOf("image")},ChooseFile:function(){if(this.form.title.length<2)uni.showToast({title:"标题不能为空",icon:"none"});else{var e=this;uni.chooseImage({count:9,sizeType:["original"],sourceType:["album"],success:function(t){if(uni.showLoading({title:"正在上传"}),t.tempFilePaths.length>0)for(var i in e.fileList=e.fileList.concat(t.tempFiles),t.tempFilePaths)uni.uploadFile({url:"http://103.222.189.2:9005/center/center/uploadFile/",filePath:t.tempFilePaths[i],name:"file",formData:{title:e.form.article,token:uni.getStorageSync("UTOKEN")},success:function(t){var i=JSON.parse(t.data);200==t.statusCode||0==i["error_num"]?(uni.hideLoading(),uni.showToast({title:"上传成功"}),console.log("success"),e.resfilepath=e.resfilepath.concat(i["msg"]),console.log(e.resfilepath)):(console.log("error"),uni.showToast({title:"发布失败，请检查网络，或联系工程师",icon:"none"}))}});else console.log(e.fileList.length),e.fileList=t.tempFiles}})}},ViewFile:function(e){var t=this;uni.previewImage({current:e,urls:t.fileList})},DelFile:function(e){var t=this;t.fileList.splice(e.currentTarget.dataset.index,1),console.log(t.fileList)},close_pro:function(){this.produ=!1,uni.removeStorageSync("zc")},onImg:function(e){this.pics=e.allImages;var t=e.allImages;for(var i in t){var a=t[i].id;this.photos[i]=a}},sub:function(){if(this.form.title.length<3||this.form.article.length<3)uni.showToast({title:"标题或内容不能为空",icon:"none"});else{console.log(this.pics);var e=[];e=this.resfilepath,console.log(uni.getStorageSync("PRO_NAME")),uni.request({url:"http://103.222.189.2:9005/center/center/add_jour/",method:"POST",data:{title:this.form.title,author:uni.getStorageSync("UNAME"),imageList:e,content:this.form.article,cover_img:uni.getStorageSync("UIMG"),belong_to:uni.getStorageSync("PRO_NAME"),token:uni.getStorageSync("UTOKEN")},success:function(e){uni.showToast({title:"发表成功！"}),console.log(e);var t=getCurrentPages(),i=t[t.length-2];uni.navigateBack({success:function(){i.watch}})},fail:function(){},complete:function(){}}),this.form.imgs=this.photos}}}};t.default=s},f837:function(e,t,i){"use strict";i.r(t);var a=i("a27d"),n=i("22f2");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("93c5");var s,r=i("f0c5"),l=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"5c8ad676",null,!1,a["a"],s);t["default"]=l.exports},f976:function(e,t,i){"use strict";var a;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("xinde")],1)},o=[]},fc40:function(e,t,i){"use strict";var a;i("a434"),i("d3b7"),i("3ca3"),i("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={name:"robby-image-upload",props:["value","enableDel","enableAdd","enableDrag","serverUrl","formData","limit","fileKeyName","showUploadProgress","serverUrlDeleteImage"],data:function(){return{role_id:"",edit_box:!1,e_data:"",imageBasePos:{x0:-1,y0:-1,w:-1,h:-1},showMoveImage:!1,moveImagePath:"",moveLeft:0,moveTop:0,deltaLeft:0,deltaTop:0,dragIndex:null,targetImageIndex:null}},computed:{posMoveImageLeft:function(){return this.moveLeft+"px"},posMoveImageTop:function(){return this.moveTop+"px"},isShowDel:function(){return!1!==this.enableDel},isShowAdd:function(){return!1!==this.enableAdd&&!(this.limit&&this.value.length>=this.limit)},isDragable:function(){return!1!==this.enableDrag}},methods:{sub:function(){this.$emit("sub")},selectImage:function(){a=this,a.value||(a.value=[]),uni.chooseImage({count:a.limit?a.limit-a.value.length:999,success:function(e){var t=e.tempFilePaths;if(a.limit){var i=a.limit-a.value.length;if(i<t.length)return void uni.showToast({title:"图片总数限制为"+a.limit+"张，当前还可以选"+i+"张",icon:"none",mask:!1,duration:2e3})}console.log("s1:",t);for(var n=[],o=0;o<t.length;o++)n.push(t[o]);if(a.serverUrl){for(var s=a.value.length-t.length,r=[],l=(a.fileKeyName&&a.fileKeyName,0),d=function(e){r.push(new Promise((function(i,n){var o=s+e;uni.uploadFile({url:a.serverUrl,filePath:t[e],name:"pic",success:function(e){200===e.statusCode?(a.value.push(JSON.parse(e.data)),console.log("s3:",a.value),l++,a.showUploadProgress&&uni.showToast({title:"上传进度："+l+"/"+t.length,icon:"none",mask:!1,duration:1e3}),console.log("success to upload image: "+e.data),i("success to upload image:"+o)):(console.log("fail to upload image:"+e.data),n("failt to upload image:"+o))},fail:function(e){console.log("fail to upload image:"+e),n("failt to upload image:"+o)}})})))},c=0;c<t.length;c++)d(c);Promise.all(r).then((function(e){console.log("s4:",a.value),a.$emit("add",{currentImages:t,allImages:a.value}),a.$emit("input",a.value)}))}else a.$emit("add",{currentImages:t,allImages:a.value}),a.$emit("input",a.value)}})},deleteImage:function(e){var t=this;uni.showModal({title:"提示",content:"确定删除？",success:function(i){if(i.confirm){var a=e.currentTarget.dataset.index;t.value[a];t.value.splice(a,1)}}})},del:function(e){var t=e.id;this.serverUrlDeleteImage&&uni.request({url:this.serverUrlDeleteImage,method:"POST",header:{token:uni.getStorageSync("token")},data:{id:t},success:function(e){console.log(e.data)}}),this.$emit("delete",{currentImage:e,allImages:this.value}),this.$emit("input",this.value)},previewImage:function(e){var t=e.currentTarget.dataset.index;uni.previewImage({current:this.value[t],indicator:"number",loop:"true",urls:this.value})},initImageBasePos:function(){var e=.024;a=this,uni.getSystemInfo({success:function(t){var i=t.screenWidth,n=Math.ceil(e*i),o=Math.ceil((i-2*n)/4);a.imageBasePos.x0=n,a.imageBasePos.w=o,a.imageBasePos.h=o}})},findOverlapImage:function(e,t){var i=Math.floor((e-this.imageBasePos.x0)/this.imageBasePos.w),a=Math.floor((t-this.imageBasePos.y0)/this.imageBasePos.h),n=4*a+i;return n},isDragging:function(e){return this.dragIndex===e},start:function(e){if(this.isDragable){if(this.dragIndex=e.currentTarget.dataset.index,this.moveImagePath=this.value[this.dragIndex],this.showMoveImage=!0,-1===this.imageBasePos.y0){this.initImageBasePos();var t=Math.floor(this.dragIndex/4)*this.imageBasePos.h,i=e.currentTarget.offsetTop;this.imageBasePos.y0=i-t}this.moveLeft=e.target.offsetLeft,this.moveTop=e.target.offsetTop}},move:function(e){if(this.isDragable){var t=e.touches[0];this.targetImageIndex=this.findOverlapImage(t.clientX,t.clientY),0===this.deltaLeft&&(this.deltaLeft=t.clientX-this.moveLeft,this.deltaTop=t.clientY-this.moveTop),this.moveLeft=t.clientX-this.deltaLeft,this.moveTop=t.clientY-this.deltaTop}},stop:function(e){this.isDragable&&(null!==this.dragIndex&&null!==this.targetImageIndex&&(this.targetImageIndex<0&&(this.targetImageIndex=0),this.targetImageIndex>=this.value.length&&(this.targetImageIndex=this.value.length-1),this.dragIndex!==this.targetImageIndex&&(this.value[this.dragIndex]=this.value[this.targetImageIndex],this.value[this.targetImageIndex]=this.moveImagePath)),this.dragIndex=null,this.targetImageIndex=null,this.deltaLeft=0,this.deltaTop=0,this.showMoveImage=!1,this.$emit("move",this.value))}}};t.default=n}}]);